<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Boot</title><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="article" title="Boot"><div class="titlepage"><div><div><h2 class="title"><a name="idm14619856"></a>Boot</h2></div><div><div class="author"><h3 class="author"><span class="firstname">Leo</span> <span class="surname">Ye</span></h3></div></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="#idp107280">Boot Sector</a></span></dt><dt><span class="sect1"><a href="#idp109744">Loader</a></span></dt><dt><span class="sect1"><a href="#idp110832">Memory Layout</a></span></dt></dl></div><div class="sect1" title="Boot Sector"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idp107280"></a>Boot Sector</h2></div></div></div><p>On an IBM PC compatible machine, the BIOS selects a boot device,
			then copies the first sector from the device, into physical memory
			at address 0x7c00.
			The last two byte at boot sector, should be 0x55, 0xAA.</p><p>My project follows this rule, I use floopy disk(virtualize)
			as boot device. It is created by bximage, and I place it in directory
			"image/", named "my_os.img".</p><p>The source code of boot sector is "boot.asm", and generate "boot.bin".
			I use command "dd" to write it into "my_os.img".
			Because of the sector size limit, "boot.bin" is small and simple, 
			it just read my_os.img(I make FAT12 filesystem on it) to find "load.bin".
			"load.bin" is copied into memory at address 0x80000, and it will load
			the my kernel.  </p><p>TODO: FAT12</p></div><div class="sect1" title="Loader"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idp109744"></a>Loader</h2></div></div></div><p>The source code of loader is "loader.asm".</p><p>Loader read my_os.img to find "kernel.bin",
			copy it to memory at address 0x90000, then jump into protect mode.
			Set paging, copy program section of "kernel.bin" into address 0x30400.</p><p>TODO: protect mode, ELF, paging</p></div><div class="sect1" title="Memory Layout"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idp110832"></a>Memory Layout</h2></div></div></div><img src="res/mem_layout.jpeg"></div></div></body></html>
